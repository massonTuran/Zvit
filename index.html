<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Форма звітності — Туран</title>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { background-color: #0e0e0e; color: #eaeaea; font-family: system-ui, sans-serif; overflow-x: hidden; }
    select, input, textarea { color: white !important; font-size: 16px !important; } 
    .top-strip { position: fixed; top: 0; left: 0; right: 0; height: 6px; background-color: #1e5eff; z-index: 100; }
    .bottom-strip { position: fixed; bottom: 0; left: 0; right: 0; height: 6px; background-color: #f2c300; z-index: 100; }
    .custom-input { background-color: #454353 !important; border: 1px solid #333 !important; border-radius: 0.5rem !important; padding: 0.6rem !important; }
    .time-btn { background: #454353; color: white !important; padding: 0 10px; border-radius: 8px; font-weight: bold; border: 1px solid #555; }
    .author-tag { text-align: center; margin-top: 12px; font-size: 11px; opacity: 0.4; letter-spacing: 1px; text-transform: uppercase; padding-bottom: 25px; }
    .form-card { width: 98%; max-width: 500px; background-color: #181818; padding: 1.25rem; border-radius: 0.75rem; margin: 20px auto; }
  </style>
</head>
<body>

<div id="app" class="min-h-screen flex flex-col pt-2">
  <div class="top-strip"></div>
  <div class="bottom-strip"></div>

  <div class="form-card shadow-2xl">
    <form @submit.prevent>
      
      <div class="mb-4">
        <label class="mb-1 text-sm opacity-70 font-semibold uppercase">Підрозділ:</label>
        <select v-model="formData.pidrozdil" class="custom-input w-full">
          <option v-for="unit in units" :key="unit" :value="unit">{{ unit }}</option>
        </select>
      </div>

      <div class="mb-4">
        <label class="mb-1 text-sm opacity-70 font-semibold uppercase">Позивний:</label>
        <div class="flex gap-2">
          <select v-model="formData.pozivniyPrefix" class="w-1/3 custom-input">
            <option v-for="p in prefixes" :key="p" :value="p">{{ p }}</option>
          </select>
          <input v-model="formData.pozivniy" type="text" placeholder="Впишіть" class="w-2/3 custom-input">
        </div>
      </div>

      <div class="grid grid-cols-2 gap-2 mb-4">
        <input v-model="formData.date" type="date" class="custom-input w-full">
        <div class="flex gap-1">
          <button type="button" @click="adjustTime(-1)" class="time-btn">-</button>
          <input v-model="formData.time" type="time" class="custom-input w-full text-center">
          <button type="button" @click="adjustTime(1)" class="time-btn">+</button>
        </div>
      </div>

      <div class="mb-4">
        <label class="mb-1 text-sm opacity-70 font-semibold uppercase">Результат:</label>
        <select v-model="formData.result" class="custom-input">
          <option v-for="res in results" :key="res" :value="res">{{ res }}</option>
        </select>
      </div>

      <div class="my-4 p-3 bg-[#222] rounded-lg border border-gray-700">
        <div v-if="formData.result === 'вибух'">
          <div class="grid grid-cols-2 gap-2 mb-2">
            <div class="flex items-center gap-1"><span>А-</span><input v-model="formData.angle" class="custom-input w-full p-1 text-sm"></div>
            <div class="flex items-center gap-1"><span>Д-</span><input v-model="formData.distance" class="custom-input w-full p-1 text-sm"></div>
          </div>
          <select v-model="formData.okiStatus" class="custom-input text-sm w-full">
            <option value="без пошкоджень">без пошкоджень ОКІ</option>
            <option value="пошкоджено">пошкоджено ОКІ</option>
          </select>
        </div>
        <div v-else>
          <div class="grid grid-cols-3 gap-1 mb-2">
            <div class="flex items-center gap-1"><span>А-</span><input v-model="formData.angle" class="custom-input w-full p-1 text-sm"></div>
            <div class="flex items-center gap-1"><span>Д-</span><input v-model="formData.distance" class="custom-input w-full p-1 text-sm"></div>
            <div class="flex items-center gap-1"><span>К-</span><input v-model="formData.krok" class="custom-input w-full p-1 text-sm"></div>
          </div>
          <div class="grid grid-cols-3 gap-1">
            <select v-model="formData.action" class="custom-input p-1 text-[11px]"><option v-for="a in actions" :value="a">{{a}}</option></select>
            <select v-model="formData.targetCount" class="custom-input p-1 text-xs"><option v-for="n in 9" :value="n">{{n}}</option></select>
            <select v-model="formData.targetClass" class="custom-input p-1 text-[11px]"><option v-for="c in classes" :value="c">{{c}}</option></select>
          </div>
        </div>
      </div>

      <button @click="copyData" class="w-full bg-green-700 py-4 rounded-xl font-bold uppercase mb-3 active:bg-green-800 shadow-lg">1. Скопіювати текст</button>
      
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button @click="openApp('Signal')" class="bg-[#2052ce] text-white py-3 rounded-lg font-bold text-sm uppercase">2. Відкрити Signal</button>
        <button @click="openApp('WhatsApp')" class="bg-[#25D366] text-white py-3 rounded-lg font-bold text-sm uppercase">2. Відкрити WhatsApp</button>
      </div>

      <button @click="clearForm" class="w-full border border-gray-600 py-2 rounded-xl text-[10px] uppercase opacity-40">Очистити все</button>
      
      <div v-if="lastSent" class="text-center text-xs text-yellow-500 mt-2 uppercase">Останній раз: {{ lastSent }}</div>
      <div class="author-tag">© By Туран</div>
    </form>
  </div>
</div>

<script>
  new Vue({
    el: '#app',
    data: {
      lastSent: localStorage.getItem('lastSent_Turan'),
      formData: {
        pidrozdil: 'ПвК Центр', pozivniyPrefix: 'МВГ', pozivniy: '', naseleniyPunkt: '', oblast: 'Київська',
        date: '', time: '', result: 'не застосовувалась', angle: '0', distance: '0', krok: '0',
        action: 'обстріляно', targetCount: '1', targetClass: 'БПЛА', okiStatus: 'без пошкоджень', comment: ''
      },
      units: ['ПвК Центр', '138 ртбр', '96 зрбр', '14 зрбр', '156 зрп', 'ДПСУ', 'НГУ', 'ГУР'],
      prefixes: ['МВГ', 'ВГ'],
      results: ['не застосовувалась', 'не знищено', 'ЗНИЩЕНО', 'вибух'],
      actions: ['обстріляно', 'знищено', 'Акустично', 'Візуально'],
      classes: ['БПЛА', 'КР', 'Гелікоптер', 'Літак малий']
    },
    methods: {
      updateDateTime() {
        const now = new Date();
        this.formData.date = now.toISOString().split('T')[0];
        this.formData.time = now.toTimeString().slice(0, 5);
      },
      adjustTime(mins) {
        let [h, m] = this.formData.time.split(':').map(Number);
        const d = new Date(); d.setHours(h, m + mins);
        this.formData.time = d.toTimeString().slice(0, 5);
      },
      generateText() {
        const f = this.formData;
        let text = `Дата: ${f.date.split('-').reverse().join('.')}\nЧас: ${f.time}\nРезультат: ${f.result}\nН.П.: ${f.naseleniyPunkt}\nПідрозділ: ${f.pidrozdil}\nПозивний: ${f.pozivniyPrefix} ${f.pozivniy}\n`;
        if (f.result !== 'вибух') {
          text += `Опис: А-${f.angle}, Д-${f.distance}, К-${f.krok}, ${f.action} ${f.targetCount} ${f.targetClass}`;
        } else {
          text += `Опис: А-${f.angle}, Д-${f.distance}, Стан ОКІ: ${f.okiStatus}`;
        }
        return text;
      },
      copyData() {
        const text = this.generateText();
        const el = document.createElement('textarea');
        el.value = text;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        alert("Текст скопійовано! Тепер натисніть на кнопку месенджера.");
      },
      openApp(app) {
        this.lastSent = app;
        localStorage.setItem('lastSent_Turan', app);
        if (app === 'WhatsApp') {
          window.location.href = "https://wa.me/?text=" + encodeURIComponent(this.generateText());
        } else {
          window.location.href = "sgnl://";
        }
      },
      clearForm() { if(confirm("Очистити все?")) { localStorage.clear(); location.reload(); } }
    },
    created() { this.updateDateTime(); }
  });
</script>
</body>
</html>
